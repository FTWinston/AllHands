import { Vulnerability } from 'common-types';
import { classNames } from 'common-ui/classNames';
import { getVulnerabilityDescription } from 'common-ui/getVulnerabilityDescription';
import { InfoPopup } from 'common-ui/InfoPopup';
import { ToggleButton } from 'common-ui/ToggleButton';
import styles from './VulnerabiltyIndicator.module.css';

type Props = {
    vulnerability: Vulnerability;
    onSelected: (isSelected: boolean) => void;
    isSelected: boolean;
    anySelected: boolean;
};

export const VulnerabilityIndicator = (props: Props) => {
    const { name, description, image } = getVulnerabilityDescription(props.vulnerability);

    return (
        <InfoPopup
            className={classNames(styles.vulnerability, props.anySelected && !props.isSelected ? styles.otherIsSelected : undefined)}
            name={name}
            description={(
                <>
                    {description}

                    <div className={styles.buttons}>
                        <ToggleButton pressed={props.isSelected} onPressedChanged={pressed => props.onSelected(pressed)}>
                            Target this vulnerability
                        </ToggleButton>
                    </div>
                </>
            )}
            palette={props.isSelected ? 'danger' : 'primary'}
        >
            {image}
        </InfoPopup>
    );
};
